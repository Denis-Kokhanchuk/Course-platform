// –ë–∞–∑–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö
const siteData = {
  "courses": [
    {
      "id": "p",
      "title": "Python Junior to Senior",
      "description": "Python Junior –¥–æ Senior —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ ‚Äî —Ü–µ –ø–æ–≤–Ω–∏–π –∫—É—Ä—Å –∑ Python, —è–∫–∏–π –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤—ñ–¥ –∞–±—Å–æ–ª—é—Ç–Ω–∏—Ö –æ—Å–Ω–æ–≤ –¥–æ —Ä—ñ–≤–Ω—è –≤–ø–µ–≤–Ω–µ–Ω–æ–≥–æ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –ø—Ä–æ—î–∫—Ç–∞–º–∏, –ø—Ä–∞–∫—Ç–∏–∫–æ—é —Ç–∞ —Ä–æ–∑—É–º—ñ–Ω–Ω—è–º, —è–∫ –ø—Ä–∞—Ü—é—î Python —É –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω—ñ–π —Ä–æ–∑—Ä–æ–±—Ü—ñ.",
      "fullDescription": "–ö—É—Ä—Å ¬´Python Junior –¥–æ Senior —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞¬ª —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è —Ç–∏—Ö, —Ö—Ç–æ —Ö–æ—á–µ –∑ –Ω—É–ª—è –∞–±–æ –∑ –±–∞–∑–æ–≤–∏–º–∏ –∑–Ω–∞–Ω–Ω—è–º–∏ –≤–∏—Ä–æ—Å—Ç–∏ –¥–æ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–æ–≥–æ Python-—Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞.\n\n–ù–∞–≤—á–∞–Ω–Ω—è –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç—É: —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É Python, –∑–º—ñ–Ω–Ω–∏—Ö, —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö, —É–º–æ–≤, —Ü–∏–∫–ª—ñ–≤ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–π. –î–∞–ª—ñ –∫—É—Ä—Å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –¥–æ –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–∏—Ö —Ç–µ–º: —Ä–æ–±–æ—Ç–∏ –∑ —Ñ–∞–π–ª–∞–º–∏, –º–æ–¥—É–ª—è–º–∏, –ø–æ–º–∏–ª–∫–∞–º–∏, –æ–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (OOP), –∫–æ–ª–µ–∫—Ü—ñ–π, –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ —ñ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–∏—Ö.\n\n–ù–∞ —Ä—ñ–≤–Ω—ñ Middle —Å—Ç—É–¥–µ–Ω—Ç–∏ –≤–∏–≤—á–∞—é—Ç—å —Ä–æ–±–æ—Ç—É –∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞–º–∏, –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–º–∏ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞–º–∏, Git, —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è–º, –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö, API —Ç–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ —á–∏—Å—Ç–æ–≥–æ –∫–æ–¥—É.\n–ù–∞ —Ä—ñ–≤–Ω—ñ Senior —É–≤–∞–≥–∞ –ø—Ä–∏–¥—ñ–ª—è—î—Ç—å—Å—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ, –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó, –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—é, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—ñ, –∫—Ä–∞—â–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º —Ä–æ–∑—Ä–æ–±–∫–∏ —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤—Ü—ñ –¥–æ —Ä–µ–∞–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –≤ –∫–æ–º–∞–Ω–¥—ñ.\n\n–ö—É—Ä—Å –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ:\n‚úî —Ä–µ–∞–ª—å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏\n‚úî –∑–∞–≤–¥–∞–Ω–Ω—è –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –º–æ–¥—É–ª—è\n‚úî –ø—Ä–æ—î–∫—Ç–∏ –¥–ª—è –ø–æ—Ä—Ç—Ñ–æ–ª—ñ–æ\n‚úî –ø–æ—è—Å–Ω–µ–Ω–Ω—è ¬´—á–æ–º—É —Ç–∞–∫, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —è–∫¬ª\n\n–ö–æ–º—É –ø—ñ–¥—ñ–π–¥–µ –∫—É—Ä—Å:\n\n–ø–æ–≤–Ω–∏–º –Ω–æ–≤–∞—á–∫–∞–º —É –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—ñ\n\n—Ç–∏–º, —Ö—Ç–æ –∑–Ω–∞—î Python –Ω–∞ –±–∞–∑–æ–≤–æ–º—É —Ä—ñ–≤–Ω—ñ\n\n—Å—Ç—É–¥–µ–Ω—Ç–∞–º —Ç–∞ —à–∫–æ–ª—è—Ä–∞–º\n\n—Ç–∏–º, —Ö—Ç–æ —Ö–æ—á–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ Python-—Ä–æ–∑—Ä–æ–±–Ω–∏–∫–æ–º –∞–±–æ –∑—Ä–æ—Å—Ç–∏ –¥–æ Senior-—Ä—ñ–≤–Ω—è\n\n–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—ñ—Å–ª—è –∫—É—Ä—Å—É:\n\n–≤–ø–µ–≤–Ω–µ–Ω–µ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è Python\n\n—Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ä—ñ–≤–Ω—ñ–≤ Junior / Middle / Senior\n\n–ø—Ä–∞–∫—Ç–∏—á–Ω–∏–π –¥–æ—Å–≤—ñ–¥ —Ç–∞ –ø—Ä–æ—î–∫—Ç–∏\n\n–≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–æ —Å–ø—ñ–≤–±–µ—Å—ñ–¥ —ñ —Ä–µ–∞–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏",
      "image": "default-course.jpg",
      "lessonsCount": 1
    }
  ],
  "lessons": [
    {
      "id": "lesson-1768502902474-bgnbwbpe5",
      "courseId": "p",
      "title": "–û—Å–Ω–æ–≤–∏ Python: –≤–∏–≤—ñ–¥, –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞ –∑–º—ñ–Ω–Ω—ñ",
      "order": 1,
      "videoId": "I0uWXbkRs0k",
      "description": "–£ —Ü—å–æ–º—É –≤—ñ–¥–µ–æ —è –ø–æ—è—Å–Ω—é—é –±–∞–∑–æ–≤—ñ —Ä–µ—á—ñ –º–æ–≤–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è Python:\nüîπ —â–æ —Ç–∞–∫–µ print() —ñ —è–∫ –≤–∏–≤–æ–¥–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –Ω–∞ –µ–∫—Ä–∞–Ω\nüîπ —è–∫ –ø—Ä–∞—Ü—é—î input() —ñ —è–∫ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞\nüîπ —â–æ —Ç–∞–∫–µ –∑–º—ñ–Ω–Ω—ñ —Ç–∞ —è–∫ —ó—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏",
      "fullDescription": "–£ —Ü—å–æ–º—É –≤—ñ–¥–µ–æ —è –ø–æ—è—Å–Ω—é—é –±–∞–∑–æ–≤—ñ —Ä–µ—á—ñ –º–æ–≤–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è Python:\nüîπ —â–æ —Ç–∞–∫–µ print() —ñ —è–∫ –≤–∏–≤–æ–¥–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –Ω–∞ –µ–∫—Ä–∞–Ω\nüîπ —è–∫ –ø—Ä–∞—Ü—é—î input() —ñ —è–∫ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞\nüîπ —â–æ —Ç–∞–∫–µ –∑–º—ñ–Ω–Ω—ñ —Ç–∞ —è–∫ —ó—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏\n\n\n–í—ñ–¥–µ–æ –ø—ñ–¥—ñ–π–¥–µ –¥–ª—è –ø–æ—á–∞—Ç–∫—ñ–≤—Ü—ñ–≤, —è–∫—ñ —Ç—ñ–ª—å–∫–∏ –ø–æ—á–∏–Ω–∞—é—Ç—å –≤–∏–≤—á–∞—Ç–∏ Python –∞–±–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –∑–∞–≥–∞–ª–æ–º.\n\nüìå –ü—ñ–¥–ø–∏—Å—É–π—Å—è –Ω–∞ –∫–∞–Ω–∞–ª, —â–æ–± –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ —É—Ä–æ–∫–∏!\nüìå –ü–∏—à–∏ –ø–∏—Ç–∞–Ω–Ω—è –≤ –∫–æ–º–µ–Ω—Ç–∞—Ä—è—Ö ‚Äî —ñ–∑ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è–º –≤—ñ–¥–ø–æ–≤—ñ–º.",
      "presentation": "file:file-1768502902144-4aatx6ykp",
      "codeFile": "file:file-1768502902400-uf0k0fk1k",
      "code": ""
    }
  ],
  "settings": {
    "siteName": "Algorithmic Anchor",
    "theme": "dark"
  }
};

// –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
function getCourses() {
    return siteData.courses || [];
}

function getCourse(courseId) {
    return (siteData.courses || []).find(course => course.id === courseId);
}

function getLessons(courseId) {
    return (siteData.lessons || []).filter(lesson => lesson.courseId === courseId);
}

function getLesson(lessonId) {
    return (siteData.lessons || []).find(lesson => lesson.id === lessonId);
}

function getCourseLessonsCount(courseId) {
    return getLessons(courseId).length;
}

function getSettings() {
    return siteData.settings || {};
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ GitHub
async function updateDataFromGitHub() {
    try {
        console.log('–û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ GitHub...');
        const response = await fetch(
            'https://raw.githubusercontent.com/Denis-Kokhanchuk/Course-platform/main/data.js?t=' + Date.now()
        );
        const text = await response.text();
        
        // –ó–Ω–∞—Ö–æ–¥–∏–º–æ siteData –≤ —Ç–µ–∫—Å—Ç—ñ
        const match = text.match(/const siteData = (\{.*?\});/s);
        if (match) {
            try {
                const newData = JSON.parse(match[1]);
                window.siteData = newData;
                
                console.log('‚úÖ –î–∞–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–æ –∑ GitHub!');
                
                // –û–Ω–æ–≤–ª—é—î–º–æ UI
                if (typeof window.renderCourses === 'function') {
                    window.renderCourses();
                }
                
                // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
                if (window.showNotification) {
                    window.showNotification('–î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ!', 'success');
                }
                
                return true;
            } catch (parseError) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥—É:', parseError);
                return false;
            }
        }
        return false;
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:', error);
        return false;
    }
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
document.addEventListener('DOMContentLoaded', function() {
    // –û–Ω–æ–≤–ª—é—î–º–æ –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω
    setInterval(updateDataFromGitHub, 5 * 60 * 1000);
    
    // –û–Ω–æ–≤–ª—é—î–º–æ —è–∫—â–æ –≤ URL —î –ø–∞—Ä–∞–º–µ—Ç—Ä update
    if (new URLSearchParams(window.location.search).has('update')) {
        updateDataFromGitHub();
    }
});

// –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ñ–∞–π–ª–∞–º–∏
function getFile(fileId) {
    try {
        const mediaFiles = JSON.parse(localStorage.getItem('mediaFiles')) || [];
        return mediaFiles.find(f => f.id === fileId);
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É:', error);
        return null;
    }
}

function getFileUrl(fileId) {
    const file = getFile(fileId);
    return file?.content || null;
}

function downloadFile(fileId, fileName = null) {
    const file = getFile(fileId);
    if (!file || !file.content) return false;
    
    try {
        let content = file.content;
        if (content.includes('base64,')) {
            content = content.split('base64,')[1];
        }
        
        const byteCharacters = atob(content);
        const byteNumbers = new Array(byteCharacters.length);
        for (let i = 0; i < byteCharacters.length; i++) {
            byteNumbers[i] = byteCharacters.charCodeAt(i);
        }
        const byteArray = new Uint8Array(byteNumbers);
        const blob = new Blob([byteArray], { type: file.type });
        
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = fileName || file.name;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        return true;
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É:', error);
        return false;
    }
}

function getImageUrl(fileId) {
    const file = getFile(fileId);
    if (file && file.type.startsWith('image/') && file.content) {
        return file.content;
    }
    return 'default-course.jpg';
}